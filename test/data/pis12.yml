common:
  fields:
  - name: workflow
    width: 16
    starts_at: 2
    validate:
    - 'IDM'
  - name: record_type
    width: 8
    starts_at: 18
    validate:
    - 'PIS12'
  - name: data_specification_version
    width: 5
    starts_at: 26
    validate:
    - '1.2'
  - name: client_id_from_header
    width: 16
    starts_at: 31
    validate:
    - any
    # - '???country host based logic'
  - name: record_creation_date
    width: 8
    starts_at: 47
    validate:
    - date
  - name: record_creation_time
    width: 6
    starts_at: 55
    validate:
    - time
  - name: gmt_offset
    width: 6
    starts_at: 64
    validate:
    - '+08.00'
  - name: customer_id_from_header
    width: 20
    starts_at: 70
    validate:
    - "{ slice(0..1) == 'TW' }"
    # - "{ slice(2..100).numeric }"
  - name: customer_acct_number
    width: 40
    starts_at: 90
    validate:
    - "{ slice(0..1) == 'TW' }"
    # - "{ slice(2..100).numeric }"
    - "{ slice(2..100).length == 16 }"
  - name: external_transaction_id
    width: 32
    starts_at: 130
    validate:
    - not_blank
    - unique
  - name: pan
    width: 19
    starts_at: 162
    validate:
    - width 16
  - name: pan_open_date
    width: 8
    starts_at: 186
    validate:
    - date_or_blank
  - name: member_since_date
    width: 8
    starts_at: 194
    validate:
    - date_or_blank
  - name: number_of_payment_ids
    width: 3
    starts_at: 263
    validate:
    - numeric
    - positive
  - name: status_date
    width: 8
    starts_at: 298
    validate:
    - date
  - name: emboss_name
    width: 40
    starts_at: 318
    validate:
    - any
  - name: expiration_date
    width: 8
    starts_at: 358
    validate:
    - date_or_blank
  - name: emboss_date
    width: 8
    starts_at: 366
    validate:
    - date_or_blank
  - name: credit_limit
    width: 10
    starts_at: 392
    validate:
    - numeric_or_blank
  - name: daily_pos_limit
    width: 10
    starts_at: 412
    validate:
    - numeric

tandem:
  skip_top_lines: 1
  skip_bottom_lines: 1
  inherit_from: common
  fields:
  - name: type
    width: 1
    starts_at: 181
    validate:
    - "['M', 'D']"
  - name: sub_type
    width: 2
    starts_at: 182
    validate:
    - "['N', 'DA', 'O']"
  - name: category
    width: 1
    starts_at: 184
    validate:
    - 'S'
  - name: association
    width: 1
    starts_at: 185
    validate:
    - "['V', 'M', 'O']"
  - name: issuing_country
    width: 3
    starts_at: 202
    validate:
    - '158'
  - name: cardholder_city
    width: 40
    starts_at: 205
    validate:
    - any
  - name: cardholder_state_province
    width: 5
    starts_at: 245
    validate:
    - any
  - name: cardholder_country_code
    width: 3
    starts_at: 260
    validate:
    - not_blank
  - name: status
    width: 2
    starts_at: 296
    validate:
    - "['00', '27', '11', '20']"
  - name: pin_length
    width: 2
    starts_at: 306
    validate:
    - any
  - name: pin_set_date
    width: 8
    starts_at: 308
    validate:
    - blank
  - name: pin_type
    width: 1
    starts_at: 316
    validate:
    - blank
  - name: active_indicator
    width: 1
    starts_at: 317
    validate:
    - "['Y', 'N']"
  - name: plastic_issue_type
    width: 1
    starts_at: 374
    validate:
    - "['R', 'I']"
  - name: incentive
    width: 1
    starts_at: 375
    validate:
    - "['C', 'N']"
  - name: currency_code
    width: 3
    starts_at: 376
    validate:
    - '901'
  - name: currency_conversion_rate
    width: 13
    starts_at: 379
    validate:
    - "['000001.000000', '1.000000']"
  - name: daily_cash_limit
    width: 10
    starts_at: 422
    validate:
    - '0000200000'
  - name: cashback_limit_mode
    width: 1
    starts_at: 432
    validate:
    - '0'
  - name: media_type
    width: 1
    starts_at: 433
    validate:
    - 'C'
  - name: aip_static
    width: 1
    starts_at: 434
    validate:
    - 'Y'
  - name: aip_dynamic
    width: 1
    starts_at: 435
    validate:
    - 'Y'
  - name: aip_verify
    width: 1
    starts_at: 436
    validate:
    - 'N'
  - name: aip_risk
    width: 1
    starts_at: 437
    validate:
    - 'N'
  - name: aip_issuer_authentication
    width: 1
    starts_at: 438
    validate:
    - 'N'
  - name: aip_combined
    width: 1
    starts_at: 439
    validate:
    - 'N'
  - name: chip_specification
    width: 1
    starts_at: 440
    validate:
    - 'V'
  - name: chip_spec_version
    width: 3
    starts_at: 441
    validate:
    - '210'
